<!-- BookOrdering BPEL Process [Generated by the Eclipse BPEL Designer] -->
<!-- Date: Mon Mar 05 14:52:21 IST 2012 -->
<bpel:process name="BookOrdering" targetNamespace="http://process.waa.swin.edu.au"
	suppressJoinFailure="yes" xmlns:tns="http://process.waa.swin.edu.au"
	xmlns:bpel="http://docs.oasis-open.org/wsbpel/2.0/process/executable"
	xmlns:ns1="http://process.waa.swin.edu.auArtifacts" xmlns:ns="http://process.swin.edu.au"
	xmlns:ns0="http://student.waa.swin.edu.au" xmlns:ns2="http://waa.swin.edu.au"
	xmlns:ns3="http://waa.swin.edu.au" xmlns:ns4="http://ws.apache.org/axis2"
	xmlns:ns5="http://bookProxy.waa.swin.edu.au">

	<!-- ================================================================= -->
	<!-- ORCHESTRATION LOGIC -->
	<!-- Set of activities coordinating the flow of messages across the -->
	<!-- services integrated within this business process -->
	<!-- ================================================================= -->
    <bpel:import namespace="http://process.swin.edu.au" location="bookOrdering.wsdl" importType="http://schemas.xmlsoap.org/wsdl/"></bpel:import>
    <bpel:import namespace="http://student.waa.swin.edu.au" location="StudentServiceSOAP.wsdl" importType="http://schemas.xmlsoap.org/wsdl/"></bpel:import>
    <bpel:import namespace="http://waa.swin.edu.au" location="BookInventorySOAP.wsdl" importType="http://schemas.xmlsoap.org/wsdl/"></bpel:import>
    <bpel:import namespace="http://bookProxy.waa.swin.edu.au" location="BookInformationServiceSOAP.wsdl" importType="http://schemas.xmlsoap.org/wsdl/"></bpel:import>

	<bpel:import namespace="http://process.waa.swin.edu.auArtifacts"
		location="BookOrderingArtifacts.wsdl" importType="http://schemas.xmlsoap.org/wsdl/"></bpel:import>
	<bpel:partnerLinks>
		<bpel:partnerLink name="clientPartnerLink"
			partnerLinkType="ns1:ClientPTL" myRole="bookOrderingOperation"></bpel:partnerLink>
		<bpel:partnerLink name="StudentServicePartnerLink"
			partnerLinkType="ns1:StudentServicePTL" partnerRole="studentServiceProvider"></bpel:partnerLink>
        
        
        
        
        
        
        <bpel:partnerLink name="BookInformationServiceSOAPPartnerLink" partnerLinkType="ns1:BookInformationServiceSOAPPLT" partnerRole="BookInformationServiceProvider"></bpel:partnerLink>
        <bpel:partnerLink name="BookInventoryPartnerLink" partnerLinkType="ns1:BoonInventoryPLT" partnerRole="BookInventoryProvider"></bpel:partnerLink>
    </bpel:partnerLinks>    
    <bpel:variables>
        <bpel:variable name="clientPartnerLinkRequest" messageType="ns:orderBookRequest"></bpel:variable>
        <bpel:variable name="clientPartnerLinkResponse" messageType="ns:orderBookResponse"></bpel:variable>
        
        
        
        
        <bpel:variable name="BookInformationServiceSOAPPartnerLinkResponse" messageType="ns5:retrieveBookDetailsResponse"></bpel:variable>
        <bpel:variable name="BookInformationServiceSOAPPartnerLinkRequest" messageType="ns5:retrieveBookDetailsRequest"></bpel:variable>
        
        
        <bpel:variable name="StudentServicePartnerLinkResponse" messageType="ns0:authenticateResponse"></bpel:variable>
        <bpel:variable name="StudentServicePartnerLinkRequest" messageType="ns0:authenticateRequest"></bpel:variable>
        <bpel:variable name="BookInventoryPartnerLinkResponse" messageType="ns2:validateBookOrderResponse"></bpel:variable>
        <bpel:variable name="BookInventoryPartnerLinkRequest" messageType="ns2:validateBookOrderRequest"></bpel:variable>
        <bpel:variable name="BookInventoryPartnerLinkResponse1" messageType="ns2:addBookResponse"></bpel:variable>
        <bpel:variable name="BookInventoryPartnerLinkRequest1" messageType="ns2:addBookRequest"></bpel:variable>
    </bpel:variables>
    <bpel:sequence name="main">
        <bpel:receive name="receiveInputs" partnerLink="clientPartnerLink" createInstance="yes" operation="orderBook" portType="ns:BookOrderingPort" variable="clientPartnerLinkRequest"></bpel:receive>
        <bpel:assign validate="no" name="assignStudentValidationInput">
            
            
        
            
            <bpel:copy>
                <bpel:from><bpel:literal><ns:authenticateStudent xmlns:ns="http://student.waa.swin.edu.au" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <ns:studentId>0</ns:studentId>
  <ns:pin>0</ns:pin>
</ns:authenticateStudent>
</bpel:literal></bpel:from>
                <bpel:to part="parameters" variable="StudentServicePartnerLinkRequest"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="parameters" variable="clientPartnerLinkRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[studentId]]>
                    </bpel:query>
                </bpel:from>
                <bpel:to part="parameters" variable="StudentServicePartnerLinkRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns0:studentId]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="parameters" variable="clientPartnerLinkRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[pin]]>
                    </bpel:query>
                </bpel:from>
                <bpel:to part="parameters" variable="StudentServicePartnerLinkRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns0:pin]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
        </bpel:assign>
        <bpel:invoke name="invokeStudentValidationService" partnerLink="StudentServicePartnerLink" operation="authenticate" portType="ns0:StudentServiceSOAPPortType" inputVariable="StudentServicePartnerLinkRequest" outputVariable="StudentServicePartnerLinkResponse"></bpel:invoke>
        <bpel:if name="IfPositive"><bpel:condition expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[$StudentServicePartnerLinkResponse.parameters/ns0:return="Authentication Successful"]]></bpel:condition>
            <bpel:sequence>
                <bpel:assign validate="no" name="assignBookValidationInput">
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    <bpel:copy>
                        <bpel:from><bpel:literal><ns:validateBookOrder xmlns:ns="http://waa.swin.edu.au" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <ns:isbn>0</ns:isbn>
</ns:validateBookOrder></bpel:literal></bpel:from>
                        <bpel:to variable="BookInventoryPartnerLinkRequest" part="parameters"></bpel:to>
                    </bpel:copy>
                    
                    <bpel:copy>
                        <bpel:from part="parameters" variable="clientPartnerLinkRequest">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                                <![CDATA[isbn]]>
                            </bpel:query>
                        </bpel:from>
                        <bpel:to part="parameters" variable="BookInventoryPartnerLinkRequest">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                                <![CDATA[ns2:isbn]]>
                            </bpel:query>
                        </bpel:to>
                    </bpel:copy>
                </bpel:assign>
                <bpel:invoke name="invokeBookValidationService" partnerLink="BookInventoryPartnerLink" operation="validateBookOrder" portType="ns2:BookInventoryServiceSOAPPortType" inputVariable="BookInventoryPartnerLinkRequest" outputVariable="BookInventoryPartnerLinkResponse">
                </bpel:invoke>
                <bpel:if name="IfBookNotExistInLibrary">
                    <bpel:condition expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[$BookInventoryPartnerLinkResponse.parameters/ns2:return="Positive"]]></bpel:condition>
                    <bpel:sequence>
                        <bpel:assign validate="no" name="assignRetriveBookInfoInputs">
                            
                        
            
                            
                            
                            
                            
                            <bpel:copy>
                                <bpel:from><bpel:literal><tns:retrieveBookDetails xmlns:tns="http://bookProxy.waa.swin.edu.au" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <isbn>0</isbn>
</tns:retrieveBookDetails>
</bpel:literal></bpel:from>
                                <bpel:to part="parameters" variable="BookInformationServiceSOAPPartnerLinkRequest"></bpel:to>
                            </bpel:copy>
                            <bpel:copy>
                                <bpel:from part="parameters" variable="clientPartnerLinkRequest">
                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                                        <![CDATA[isbn]]>
                                    </bpel:query>
                                </bpel:from>
                                <bpel:to part="parameters" variable="BookInformationServiceSOAPPartnerLinkRequest">
                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                                        <![CDATA[isbn]]>
                                    </bpel:query>
                                </bpel:to>
                            </bpel:copy>
                        </bpel:assign>
                        <bpel:invoke name="invokeRetrieveBookInformationService" partnerLink="BookInformationServiceSOAPPartnerLink" operation="retrieveBookDetails" portType="ns5:BookInformationSOAP" inputVariable="BookInformationServiceSOAPPartnerLinkRequest" outputVariable="BookInformationServiceSOAPPartnerLinkResponse"></bpel:invoke><bpel:if name="IfIsbnValid">
                            <bpel:condition expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[$BookInformationServiceSOAPPartnerLinkResponse.parameters/isbnValidity="valid"]]></bpel:condition>
                            <bpel:if name="IfAvaliableInAustralia"><bpel:condition expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[$BookInformationServiceSOAPPartnerLinkResponse.parameters/australianAvailability="FOR_SALE"]]></bpel:condition>
                                <bpel:if name="IfGoodRating">
                                    <bpel:condition expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[number($BookInformationServiceSOAPPartnerLinkResponse.parameters/averageRating)>=3]]></bpel:condition>
                                    <bpel:sequence>
                                        <bpel:assign validate="no" name="assignBookDetails">
                                            
                                            
                                            
                                            
                                            
                                            
                                            
                                            
                                        
            
                                            
                                            <bpel:copy>
                                                <bpel:from>
                                                    <bpel:literal><ns:addBook xmlns:ns="http://waa.swin.edu.au" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <ns:bookTitle>ns:bookTitle</ns:bookTitle>
  <ns:authorList>ns:authorList</ns:authorList>
  <ns:isbn10>ns:isbn10</ns:isbn10>
  <ns:isbn13>ns:isbn13</ns:isbn13>
  <ns:publisherName>ns:publisherName</ns:publisherName>
  <ns:publishDate>ns:publishDate</ns:publishDate>
  <ns:bookStatus>back order</ns:bookStatus>
</ns:addBook>
</bpel:literal>
                                                </bpel:from>
                                                <bpel:to part="parameters" variable="BookInventoryPartnerLinkRequest1">
                                                </bpel:to>
                                            </bpel:copy>
                                            <bpel:copy>
                                                <bpel:from part="parameters" variable="BookInformationServiceSOAPPartnerLinkResponse">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                                                        <![CDATA[bookTitle]]>
                                                    </bpel:query>
                                                </bpel:from>
                                                <bpel:to part="parameters" variable="BookInventoryPartnerLinkRequest1">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[ns2:bookTitle]]></bpel:query>
                                                </bpel:to>
                                            </bpel:copy>
                                            <bpel:copy>
                                                <bpel:from part="parameters" variable="BookInformationServiceSOAPPartnerLinkResponse">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[authorList]]></bpel:query>
                                                </bpel:from>
                                                <bpel:to part="parameters" variable="BookInventoryPartnerLinkRequest1">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[ns2:authorList]]></bpel:query>
                                                </bpel:to>
                                            </bpel:copy>
                                            <bpel:copy>
                                                <bpel:from part="parameters" variable="BookInformationServiceSOAPPartnerLinkResponse">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[isbn10]]></bpel:query>
                                                </bpel:from>
                                                <bpel:to part="parameters" variable="BookInventoryPartnerLinkRequest1">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[ns2:isbn10]]></bpel:query>
                                                </bpel:to>
                                            </bpel:copy>
                                            <bpel:copy>
                                                <bpel:from part="parameters" variable="BookInformationServiceSOAPPartnerLinkResponse">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[isbn13]]></bpel:query>
                                                </bpel:from>
                                                <bpel:to part="parameters" variable="BookInventoryPartnerLinkRequest1">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[ns2:isbn13]]></bpel:query>
                                                </bpel:to>
                                            </bpel:copy>
                                            <bpel:copy>
                                                <bpel:from part="parameters" variable="BookInformationServiceSOAPPartnerLinkResponse">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[publisher]]></bpel:query>
                                                </bpel:from>
                                                <bpel:to part="parameters" variable="BookInventoryPartnerLinkRequest1">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[ns2:publisherName]]></bpel:query>
                                                </bpel:to>
                                            </bpel:copy>
                                            <bpel:copy>
                                                <bpel:from part="parameters" variable="BookInformationServiceSOAPPartnerLinkResponse">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[publishDate]]></bpel:query>
                                                </bpel:from>
                                                <bpel:to part="parameters" variable="BookInventoryPartnerLinkRequest1">
                                                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[ns2:publishDate]]></bpel:query>
                                                </bpel:to>
                                            </bpel:copy>
                                            
                                        </bpel:assign>
                                        <bpel:invoke name="invokeAddBookService" partnerLink="BookInventoryPartnerLink" operation="addBook" portType="ns2:BookInventoryServiceSOAPPortType" inputVariable="BookInventoryPartnerLinkRequest1" outputVariable="BookInventoryPartnerLinkResponse1"></bpel:invoke><bpel:if name="IfPositiveResponse">
                                            <bpel:condition expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[$BookInventoryPartnerLinkResponse1.parameters/ns2:return="Positive"]]></bpel:condition>
                                            <bpel:sequence>
                                                
                                                <bpel:assign validate="no" name="assignPostiveOutput">
                                                    
                                                    
                                                    
                                                    
                                                    
                                                
                                                    
                                                    <bpel:copy>
                                                        <bpel:from><bpel:literal><n:orderBookResponse xmlns:n="http://process.swin.edu.au" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <status>Success, book order has been placed</status>
  <title>title</title>
  <authors>authors</authors>
  <publisher>publisher</publisher>
  <reason></reason>
</n:orderBookResponse></bpel:literal></bpel:from>
                                                        <bpel:to part="parameters" variable="clientPartnerLinkResponse"></bpel:to>
                                                    </bpel:copy>
                                                    <bpel:copy>
                                                        <bpel:from part="parameters" variable="BookInformationServiceSOAPPartnerLinkResponse">
                                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                                                                <![CDATA[bookTitle]]>
                                                            </bpel:query>
                                                        </bpel:from>
                                                        <bpel:to part="parameters" variable="clientPartnerLinkResponse">
                                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                                                                <![CDATA[title]]>
                                                            </bpel:query>
                                                        </bpel:to>
                                                    </bpel:copy>
                                                    <bpel:copy>
                                                        <bpel:from part="parameters" variable="BookInformationServiceSOAPPartnerLinkResponse">
                                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                                                                <![CDATA[authorList]]>
                                                            </bpel:query>
                                                        </bpel:from>
                                                        <bpel:to part="parameters" variable="clientPartnerLinkResponse">
                                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                                                                <![CDATA[authors]]>
                                                            </bpel:query>
                                                        </bpel:to>
                                                    </bpel:copy>
                                                    <bpel:copy>
                                                        <bpel:from part="parameters" variable="BookInformationServiceSOAPPartnerLinkResponse">
                                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                                                                <![CDATA[publisher]]>
                                                            </bpel:query>
                                                        </bpel:from>
                                                        <bpel:to part="parameters" variable="clientPartnerLinkResponse">
                                                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                                                                <![CDATA[publisher]]>
                                                            </bpel:query>
                                                        </bpel:to>
                                                    </bpel:copy>
                                                    
                                                    
                                                    
                                                </bpel:assign>
                                                <bpel:reply name="replyOrderSuccess" partnerLink="clientPartnerLink" operation="orderBook" portType="ns:BookOrderingPort" variable="clientPartnerLinkResponse"></bpel:reply>
                                            </bpel:sequence>
                                            <bpel:else>
                                                <bpel:sequence>
                                                    <bpel:assign validate="no" name="assignAddBookError">
                                                        <bpel:copy>
                                                            <bpel:from><bpel:literal><n:orderBookResponse xmlns:n="http://process.swin.edu.au" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <status>Fail</status>
  <title></title>
  <authors></authors>
  <publisher></publisher>
  <reason>Something went wrong when adding book to database.</reason>
</n:orderBookResponse></bpel:literal></bpel:from>
                                                            <bpel:to part="parameters" variable="clientPartnerLinkResponse"></bpel:to>
                                                        </bpel:copy>
                                                        
                                                    </bpel:assign>
                                                    <bpel:reply name="replyBookErrorOutput" partnerLink="clientPartnerLink" operation="orderBook" portType="ns:BookOrderingPort" variable="clientPartnerLinkResponse"></bpel:reply>
                                                </bpel:sequence>
                                            </bpel:else>
                                        </bpel:if>
                                        
                                    
        
        
        
                                    </bpel:sequence>
                                    <bpel:else>
                                        <bpel:sequence><bpel:assign validate="no" name="assignPoorRating">
                                            
    
    
    

                                                <bpel:copy>
                                                    <bpel:from><bpel:literal><n:orderBookResponse xmlns:n="http://process.swin.edu.au" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <status>Fail</status>
  <title></title>
  <authors></authors>
  <publisher></publisher>
  <reason>The requested book is poorly rated(has rating less than 3)</reason>
</n:orderBookResponse></bpel:literal></bpel:from>
                                                    <bpel:to part="parameters" variable="clientPartnerLinkResponse"></bpel:to>
                                                </bpel:copy>
                                                
                                            </bpel:assign>
                                            <bpel:reply name="replyPoorRatingOutput" partnerLink="clientPartnerLink" operation="orderBook" portType="ns:BookOrderingPort" variable="clientPartnerLinkResponse"></bpel:reply>
                                        
                                        </bpel:sequence>
                                    
                                    </bpel:else>
                                </bpel:if>
                                <bpel:else>
                                <bpel:sequence>
                                <bpel:assign validate="no" name="assignNotAvailble"><bpel:copy>
                            <bpel:from><bpel:literal><n:orderBookResponse xmlns:n="http://process.swin.edu.au" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <status>Fail</status>
  <title></title>
  <authors></authors>
  <publisher></publisher>
  <reason>Book is not sold in Australia</reason>
</n:orderBookResponse></bpel:literal></bpel:from>
                            <bpel:to part="parameters" variable="clientPartnerLinkResponse"></bpel:to>
                        </bpel:copy>
                        
                    
                            </bpel:assign>
                                <bpel:reply name="replyNotAvailbleOutput" partnerLink="clientPartnerLink" operation="orderBook" portType="ns:BookOrderingPort" variable="clientPartnerLinkResponse"></bpel:reply>
                                        
                                        
                                    </bpel:sequence>
                            </bpel:else>
                        
                            </bpel:if>
                            <bpel:else>
                                <bpel:sequence>
                                    <bpel:assign validate="no" name="assignInvalidIsbn">
            
            
            
        
        
    
    
    
    
                                        
                                        <bpel:copy>
                            <bpel:from><bpel:literal><n:orderBookResponse xmlns:n="http://process.swin.edu.au" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <status>Fail</status>
  <title></title>
  <authors></authors>
  <publisher></publisher>
  <reason>ISBN is invalid</reason>
</n:orderBookResponse></bpel:literal></bpel:from>
                            <bpel:to part="parameters" variable="clientPartnerLinkResponse"></bpel:to>
                        </bpel:copy>
                        
    
                                        
                                    </bpel:assign>
                                    <bpel:reply name="replyInvalidIsbnOutput" partnerLink="clientPartnerLink" operation="orderBook" portType="ns:BookOrderingPort" variable="clientPartnerLinkResponse"></bpel:reply>
                                </bpel:sequence>
                            </bpel:else>
                        </bpel:if>
                        
                        
                    
        
        
        
                    </bpel:sequence>
                    <bpel:else>
                        <bpel:sequence>
                            <bpel:assign validate="no" name="assignBookExist">
            
            
            
        
        
    
    
    
    
                        <bpel:copy>
                            <bpel:from><bpel:literal><n:orderBookResponse xmlns:n="http://process.swin.edu.au" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <status>Fail</status>
  <title></title>
  <authors></authors>
  <publisher></publisher>
  <reason>Book already exists in database</reason>
</n:orderBookResponse></bpel:literal></bpel:from>
                            <bpel:to part="parameters" variable="clientPartnerLinkResponse"></bpel:to>
                        </bpel:copy>
                        
                    </bpel:assign>
                            <bpel:reply name="replyBookExistOutput" partnerLink="clientPartnerLink" operation="orderBook" portType="ns:BookOrderingPort" variable="clientPartnerLinkResponse"></bpel:reply>
                        </bpel:sequence>
                    </bpel:else>
                </bpel:if>
                
                
            </bpel:sequence>
        
            <bpel:else><bpel:sequence>
                    <bpel:assign validate="no" name="assignIncorrectCredentialOutput">
            
            
            
        
        
    
    
    
    
                        <bpel:copy>
                            <bpel:from><bpel:literal><n:orderBookResponse xmlns:n="http://process.swin.edu.au" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <status>Fail</status>
  <title></title>
  <authors></authors>
  <publisher></publisher>
  <reason>Incorrect User Credentials</reason>
</n:orderBookResponse></bpel:literal></bpel:from>
                            <bpel:to part="parameters" variable="clientPartnerLinkResponse"></bpel:to>
                        </bpel:copy>
                        
                    </bpel:assign>
                    <bpel:reply name="replyIncorrectCredentialOutput" partnerLink="clientPartnerLink" operation="orderBook" portType="ns:BookOrderingPort" variable="clientPartnerLinkResponse"></bpel:reply>
                </bpel:sequence>
            
            </bpel:else>
        </bpel:if>
        
        
        
        
        
        
        
    
    
    
    
    
        
        
        
    </bpel:sequence>
</bpel:process>

